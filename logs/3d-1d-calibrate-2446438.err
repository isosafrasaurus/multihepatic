INFO:    Using cached SIF image
INFO:    Using cached SIF image
INFO:    gocryptfs not found, will not be able to use gocryptfs
INFO:    gocryptfs not found, will not be able to use gocryptfs
INFO:    Using cached SIF image
INFO:    gocryptfs not found, will not be able to use gocryptfs
INFO:    Using cached SIF image
INFO:    gocryptfs not found, will not be able to use gocryptfs
INFO:    Using cached SIF image
INFO:    gocryptfs not found, will not be able to use gocryptfs
INFO:    Using cached SIF image
INFO:    Using cached SIF image
INFO:    Using cached SIF image
INFO:    gocryptfs not found, will not be able to use gocryptfs
INFO:    gocryptfs not found, will not be able to use gocryptfs
INFO:    gocryptfs not found, will not be able to use gocryptfs
/usr/local/lib/python3.12/site-packages/ufl_legacy/__init__.py:243: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
/usr/local/lib/python3.12/site-packages/ufl_legacy/__init__.py:243: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
/usr/local/lib/python3.12/site-packages/ufl_legacy/__init__.py:243: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
/usr/local/lib/python3.12/site-packages/ufl_legacy/__init__.py:243: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
/usr/local/lib/python3.12/site-packages/ufl_legacy/__init__.py:243: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
/usr/local/lib/python3.12/site-packages/ufl_legacy/__init__.py:243: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
/usr/local/lib/python3.12/site-packages/ufl_legacy/__init__.py:243: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
/usr/local/lib/python3.12/site-packages/ufl_legacy/__init__.py:243: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Traceback (most recent call last):
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/study_calibrate.py", line 514, in <module>
    main()
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/study_calibrate.py", line 399, in main
Traceback (most recent call last):
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/study_calibrate.py", line 514, in <module>
    val = objective(xi)  # collective solve
          ^^^^^^^^^^^^^
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/study_calibrate.py", line 367, in objective
Traceback (most recent call last):
    sol = sim.solve(params)
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/study_calibrate.py", line 514, in <module>
          ^^^^^^^^^^^^^^^^^
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/src/simulation.py", line 29, in solve
    main()
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/study_calibrate.py", line 399, in main
    main()
    val = objective(xi)  # collective solve
Traceback (most recent call last):
          ^^^^^^^^^^^^^
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/study_calibrate.py", line 399, in main
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/study_calibrate.py", line 514, in <module>
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/study_calibrate.py", line 367, in objective
Traceback (most recent call last):
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/study_calibrate.py", line 514, in <module>
Traceback (most recent call last):
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/study_calibrate.py", line 514, in <module>
    val = objective(xi)  # collective solve
    sol = sim.solve(params)
          ^^^^^^^^^^^^^
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/study_calibrate.py", line 367, in objective
          ^^^^^^^^^^^^^^^^^
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/src/simulation.py", line 29, in solve
    return self.problem.solve(params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/src/problem.py", line 53, in solve
    main()
    sol = sim.solve(params)
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/study_calibrate.py", line 399, in main
    main()
          ^^^^^^^^^^^^^^^^^
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/src/simulation.py", line 29, in solve
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/study_calibrate.py", line 399, in main
    main()
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/study_calibrate.py", line 399, in main
    return self.problem.solve(params)
    return self.problem.solve(params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/src/problem.py", line 53, in solve
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/src/problem.py", line 53, in solve
    val = objective(xi)  # collective solve
    val = objective(xi)  # collective solve
          ^^^^^^^^^^^^^
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/study_calibrate.py", line 367, in objective
    val = objective(xi)  # collective solve
          ^^^^^^^^^^^^^
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/study_calibrate.py", line 367, in objective
          ^^^^^^^^^^^^^
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/study_calibrate.py", line 367, in objective
    base = super().solve(params)
    base = super().solve(params)
    sol = sim.solve(params)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/src/problem.py", line 37, in solve
           ^^^^^^^^^^^^^^^^^^^^^
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/src/problem.py", line 37, in solve
    sol = sim.solve(params)
          ^^^^^^^^^^^^^^^^^
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/src/simulation.py", line 29, in solve
    sol = sim.solve(params)
          ^^^^^^^^^^^^^^^^^
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/src/simulation.py", line 29, in solve
    base = super().solve(params)
    return self.problem.solve(params)
          ^^^^^^^^^^^^^^^^^
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/src/simulation.py", line 29, in solve
           ^^^^^^^^^^^^^^^^^^^^^
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/src/problem.py", line 37, in solve
    return self.problem.solve(params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/src/problem.py", line 53, in solve
    return self.problem.solve(params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/src/problem.py", line 53, in solve
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/src/problem.py", line 53, in solve
    uh3d, uh1d = solve_block(
    base = super().solve(params)
                 ^^^^^^^^^^^^
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/fem/solver.py", line 22, in solve_block
           ^^^^^^^^^^^^^^^^^^^^^
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/src/problem.py", line 37, in solve
    base = super().solve(params)
    base = super().solve(params)
    uh3d, uh1d = solve_block(
                 ^^^^^^^^^^^^
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/fem/solver.py", line 22, in solve_block
           ^^^^^^^^^^^^^^^^^^^^^
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/src/problem.py", line 37, in solve
           ^^^^^^^^^^^^^^^^^^^^^
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/src/problem.py", line 37, in solve
    uh3d, uh1d = solve_block(
    uh3d, uh1d = solve_block(
                 ^^^^^^^^^^^^
                 ^^^^^^^^^^^^
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/fem/solver.py", line 22, in solve_block
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/fem/solver.py", line 22, in solve_block
    uh3d, uh1d = solve_block(
    uh3d, uh1d = solve_block(
                 ^^^^^^^^^^^^
                 ^^^^^^^^^^^^
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/fem/solver.py", line 22, in solve_block
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/fem/solver.py", line 22, in solve_block
    A, b = map(ii_assemble, (a_blocks, L_blocks))
    A, b = map(ii_assemble, (a_blocks, L_blocks))
    A, b = map(ii_assemble, (a_blocks, L_blocks))
    A, b = map(ii_assemble, (a_blocks, L_blocks))
    A, b = map(ii_assemble, (a_blocks, L_blocks))
    ^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/xii_assembly.py", line 62, in assemble
    ^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/xii_assembly.py", line 62, in assemble
    ^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/xii_assembly.py", line 62, in assemble
    ^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/xii_assembly.py", line 62, in assemble
    ^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/xii_assembly.py", line 62, in assemble
    A, b = map(ii_assemble, (a_blocks, L_blocks))
    ^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/xii_assembly.py", line 62, in assemble
Traceback (most recent call last):
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/study_calibrate.py", line 514, in <module>
    main()
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/study_calibrate.py", line 399, in main
    blocks = reshape_list(list(map(assemble, flatten_list(form))), shape)
    blocks = reshape_list(list(map(assemble, flatten_list(form))), shape)
    blocks = reshape_list(list(map(assemble, flatten_list(form))), shape)
    blocks = reshape_list(list(map(assemble, flatten_list(form))), shape)
    blocks = reshape_list(list(map(assemble, flatten_list(form))), shape)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/xii_assembly.py", line 49, in assemble
    val = objective(xi)  # collective solve
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/xii_assembly.py", line 49, in assemble
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/xii_assembly.py", line 49, in assemble
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/xii_assembly.py", line 49, in assemble
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/xii_assembly.py", line 49, in assemble
          ^^^^^^^^^^^^^
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/study_calibrate.py", line 367, in objective
    tensor = module.assemble_form(form, arity)
    tensor = module.assemble_form(form, arity)
    blocks = reshape_list(list(map(assemble, flatten_list(form))), shape)
    tensor = module.assemble_form(form, arity)
    tensor = module.assemble_form(form, arity)
    tensor = module.assemble_form(form, arity)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_assembly.py", line 38, in assemble_form
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_assembly.py", line 38, in assemble_form
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_assembly.py", line 38, in assemble_form
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_assembly.py", line 38, in assemble_form
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/xii_assembly.py", line 49, in assemble
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_assembly.py", line 38, in assemble_form
    sol = sim.solve(params)
    tensor = module.assemble_form(form, arity)
          ^^^^^^^^^^^^^^^^^
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/src/simulation.py", line 29, in solve
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_assembly.py", line 38, in assemble_form
    return self.problem.solve(params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/src/problem.py", line 53, in solve
    base = super().solve(params)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/src/problem.py", line 37, in solve
    uh3d, uh1d = solve_block(
                 ^^^^^^^^^^^^
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/fem/solver.py", line 22, in solve_block
    return assembler.assemble(form, arity)
    return assembler.assemble(form, arity)
    A, b = map(ii_assemble, (a_blocks, L_blocks))
    return assembler.assemble(form, arity)
    return assembler.assemble(form, arity)
    return assembler.assemble(form, arity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/xii_assembly.py", line 62, in assemble
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/reduced_assembler.py", line 96, in assemble
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/reduced_assembler.py", line 96, in assemble
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/reduced_assembler.py", line 96, in assemble
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/reduced_assembler.py", line 96, in assemble
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/reduced_assembler.py", line 96, in assemble
    T = self.reduction_matrix(V, TV, reduced_mesh, data)
    T = self.reduction_matrix(V, TV, reduced_mesh, data)
    T = self.reduction_matrix(V, TV, reduced_mesh, data)
    return assembler.assemble(form, arity)
    T = self.reduction_matrix(V, TV, reduced_mesh, data)
    T = self.reduction_matrix(V, TV, reduced_mesh, data)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_assembly.py", line 33, in reduction_matrix
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_assembly.py", line 33, in reduction_matrix
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_assembly.py", line 33, in reduction_matrix
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/reduced_assembler.py", line 96, in assemble
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_assembly.py", line 33, in reduction_matrix
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_assembly.py", line 33, in reduction_matrix
    return avg_mat(V, TV, reduced_mesh, data)
    return avg_mat(V, TV, reduced_mesh, data)
    return avg_mat(V, TV, reduced_mesh, data)
    return avg_mat(V, TV, reduced_mesh, data)
    return avg_mat(V, TV, reduced_mesh, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_matrix.py", line 21, in cached_average_mat
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_matrix.py", line 21, in cached_average_mat
    T = self.reduction_matrix(V, TV, reduced_mesh, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_matrix.py", line 21, in cached_average_mat
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_matrix.py", line 21, in cached_average_mat
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_matrix.py", line 21, in cached_average_mat
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    cache[key] = average_mat(V, TV, reduced_mesh, data)
    cache[key] = average_mat(V, TV, reduced_mesh, data)
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_assembly.py", line 33, in reduction_matrix
    cache[key] = average_mat(V, TV, reduced_mesh, data)
    cache[key] = average_mat(V, TV, reduced_mesh, data)
    cache[key] = average_mat(V, TV, reduced_mesh, data)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_matrix.py", line 52, in avg_mat
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_matrix.py", line 52, in avg_mat
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_matrix.py", line 52, in avg_mat
    return avg_mat(V, TV, reduced_mesh, data)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_matrix.py", line 52, in avg_mat
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_matrix.py", line 52, in avg_mat
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_matrix.py", line 21, in cached_average_mat
    Rmat = average_matrix(V, TV, shape)
    Rmat = average_matrix(V, TV, shape)
    Rmat = average_matrix(V, TV, shape)
    Rmat = average_matrix(V, TV, shape)
    Rmat = average_matrix(V, TV, shape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_matrix.py", line 74, in average_matrix
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_matrix.py", line 74, in average_matrix
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_matrix.py", line 74, in average_matrix
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_matrix.py", line 74, in average_matrix
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_matrix.py", line 74, in average_matrix
    cache[key] = average_mat(V, TV, reduced_mesh, data)
    return scalar_average_matrix(V, TV, shape)
    return scalar_average_matrix(V, TV, shape)
    return scalar_average_matrix(V, TV, shape)
    return scalar_average_matrix(V, TV, shape)
    return scalar_average_matrix(V, TV, shape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_matrix.py", line 173, in scalar_average_matrix
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_matrix.py", line 173, in scalar_average_matrix
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_matrix.py", line 52, in avg_mat
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_matrix.py", line 173, in scalar_average_matrix
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_matrix.py", line 173, in scalar_average_matrix
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_matrix.py", line 173, in scalar_average_matrix
    Rmat = average_matrix(V, TV, shape)
    TV_coordinates = TV.tabulate_dof_coordinates().reshape((TV.dim(), -1))
    TV_coordinates = TV.tabulate_dof_coordinates().reshape((TV.dim(), -1))
    TV_coordinates = TV.tabulate_dof_coordinates().reshape((TV.dim(), -1))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    TV_coordinates = TV.tabulate_dof_coordinates().reshape((TV.dim(), -1))
    TV_coordinates = TV.tabulate_dof_coordinates().reshape((TV.dim(), -1))
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_matrix.py", line 74, in average_matrix
    blocks = reshape_list(list(map(assemble, flatten_list(form))), shape)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: cannot reshape array of size 168 into shape (448,newaxis)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: cannot reshape array of size 174 into shape (448,newaxis)
    return scalar_average_matrix(V, TV, shape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_matrix.py", line 173, in scalar_average_matrix
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: cannot reshape array of size 168 into shape (448,newaxis)
ValueError: cannot reshape array of size 168 into shape (448,newaxis)
ValueError: cannot reshape array of size 168 into shape (448,newaxis)
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/xii_assembly.py", line 49, in assemble
    tensor = module.assemble_form(form, arity)
    TV_coordinates = TV.tabulate_dof_coordinates().reshape((TV.dim(), -1))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_assembly.py", line 38, in assemble_form
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: cannot reshape array of size 168 into shape (448,newaxis)
    return assembler.assemble(form, arity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/reduced_assembler.py", line 96, in assemble
    T = self.reduction_matrix(V, TV, reduced_mesh, data)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_assembly.py", line 33, in reduction_matrix
    return avg_mat(V, TV, reduced_mesh, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_matrix.py", line 21, in cached_average_mat
    cache[key] = average_mat(V, TV, reduced_mesh, data)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_matrix.py", line 52, in avg_mat
    Rmat = average_matrix(V, TV, shape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_matrix.py", line 74, in average_matrix
    return scalar_average_matrix(V, TV, shape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_matrix.py", line 173, in scalar_average_matrix
    TV_coordinates = TV.tabulate_dof_coordinates().reshape((TV.dim(), -1))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: cannot reshape array of size 168 into shape (448,newaxis)
Traceback (most recent call last):
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/study_calibrate.py", line 514, in <module>
    main()
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/study_calibrate.py", line 399, in main
    val = objective(xi)  # collective solve
          ^^^^^^^^^^^^^
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/study_calibrate.py", line 367, in objective
    sol = sim.solve(params)
          ^^^^^^^^^^^^^^^^^
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/src/simulation.py", line 29, in solve
    return self.problem.solve(params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/src/problem.py", line 53, in solve
    base = super().solve(params)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/src/problem.py", line 37, in solve
    uh3d, uh1d = solve_block(
                 ^^^^^^^^^^^^
  File "/work2/10756/piercezhang9871/stampede3/3d-1d/fem/solver.py", line 22, in solve_block
    A, b = map(ii_assemble, (a_blocks, L_blocks))
    ^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/xii_assembly.py", line 62, in assemble
    blocks = reshape_list(list(map(assemble, flatten_list(form))), shape)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/xii_assembly.py", line 49, in assemble
    tensor = module.assemble_form(form, arity)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_assembly.py", line 38, in assemble_form
    return assembler.assemble(form, arity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/reduced_assembler.py", line 96, in assemble
    T = self.reduction_matrix(V, TV, reduced_mesh, data)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_assembly.py", line 33, in reduction_matrix
    return avg_mat(V, TV, reduced_mesh, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_matrix.py", line 21, in cached_average_mat
    cache[key] = average_mat(V, TV, reduced_mesh, data)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_matrix.py", line 52, in avg_mat
    Rmat = average_matrix(V, TV, shape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_matrix.py", line 74, in average_matrix
    return scalar_average_matrix(V, TV, shape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/xii/assembler/average_matrix.py", line 173, in scalar_average_matrix
    TV_coordinates = TV.tabulate_dof_coordinates().reshape((TV.dim(), -1))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: cannot reshape array of size 162 into shape (448,newaxis)
srun: error: c454-101: tasks 0-7: Exited with exit code 1
